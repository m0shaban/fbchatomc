"""
ุงูุดุงุช ุจูุช ุงูุฑุณูู ููุฌูุน ุนูุงู ูุตุฑ - ูุญูุฏ ุณูุงูุฉ
ูููู ุจุงูุฑุฏ ุนูู ุงุณุชูุณุงุฑุงุช ุฒูุงุฑ ุตูุญุฉ ูุฌูุน ุนูุงู ูุตุฑ ุนูู ููุณุจูู
ุณูุงุก ุนุจุฑ ุงููุงุณูุฌุฑ ุฃู ุชุนูููุงุช ุงูููุดูุฑุงุช
"""

import json
import re
import os
import random
import logging
import datetime
from typing import Dict, List, Tuple, Optional, Any
from api import DeepSeekAPI
from config import BOT_SETTINGS, APP_SETTINGS

# ุฅุนุฏุงุฏ ุงูุชุณุฌูู
logging.basicConfig(
    level=getattr(logging, APP_SETTINGS["LOG_LEVEL"]),
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    filename=BOT_SETTINGS.get("LOG_FILE")
)
logger = logging.getLogger(__name__)

class ChatBot:
    """
    ุดุงุช ุจูุช ุฐูู ููุฑุฏ ุนูู ุงุณุชูุณุงุฑุงุช ุฒูุงุฑ ุตูุญุฉ ูุฌูุน ุนูุงู ูุตุฑ ุนูู ููุณุจูู
    ุณูุงุก ุนุจุฑ ุงููุงุณูุฌุฑ ุฃู ุงูุชุนูููุงุช
    """
    
    def __init__(self, data_file: str = None, api_key: Optional[str] = None):
        """
        ุชููุฆุฉ ุงูุดุงุช ุจูุช ูุชุญููู ุงูุจูุงูุงุช ูู ููู JSON
        
        :param data_file: ูุณุงุฑ ููู ุงูุจูุงูุงุช ุจุตูุบุฉ JSON
        :param api_key: ููุชุงุญ API ูุฎุฏูุฉ DeepSeek (ุงุฎุชูุงุฑู)
        """
        self.bot_name = "ูุญูุฏ ุณูุงูุฉ"  # ุงุณู ุงูุดุงุช ุจูุช
        self.data_file = data_file or BOT_SETTINGS.get("DATA_FILE", "data.json")
        self.prompts = []
        self.human_expressions = {}
        self.contact_info = {}
        self.requires_human_contact = []
        self.user_categories = []
        self.job_sectors = []
        self.personalize_response = BOT_SETTINGS.get("PERSONALIZE_RESPONSE", True)
        self.similarity_threshold = BOT_SETTINGS.get("SIMILARITY_THRESHOLD", 0.4)
        
        # ุจูุงูุงุช ุงูุฎุฏูุงุช ูุงูุฑูุงุจุท
        self.service_links = {}
        self.service_categories = {}
        
        # ุชุญููู ุงูุจูุงูุงุช ูู ููู JSON
        self.load_data()
        
        # ุชููุฆุฉ ูุงุฌูุฉ API
        self.api = DeepSeekAPI(api_key)
        
        # ุชุงุฑูุฎ ุงููุญุงุฏุซุงุช ุงูุณุงุจูุฉ ูุชุถูู ุงูุขู ุฃุณูุงุก ุงููุณุชุฎุฏููู
        self.conversation_history = {}
        
        # ุญุงูุฉ ุงููุญุงุฏุซุฉ ุงูุญุงููุฉ
        self.conversation_state = {}
        
        # ุชุนููู ูุตุฏุฑ ุงููุญุงุฏุซุฉ ุงูุญุงูู
        self.conversation_source = "messenger"  # messenger ุฃู facebook_comment

        # ุฅุนุฏุงุฏุงุช ุงูุงุณุชูุฑุงุฑูุฉ ูู ุงููุญุงุฏุซุฉ
        self.continue_conversation = BOT_SETTINGS.get("CONTINUE_CONVERSATION", True)
        self.continue_phrases = [
            "ูู ุชุญุชุงุฌ ูุฒูุฏุงู ูู ุงููุนูููุงุชุ",
            "ูู ูุฏูู ุฃุณุฆูุฉ ุฃุฎุฑูุ",
            "ูู ุชุฑุบุจ ูู ูุนุฑูุฉ ุงููุฒูุฏุ",
            "ูู ุชุฑูุฏ ุงูุงุณุชูุฑุงุฑ ูู ุงููุญุงุฏุซุฉุ",
            "ูู ุฃุณุชุทูุน ูุณุงุนุฏุชู ูู ุดูุก ุขุฎุฑุ"
        ]
        
        # ุฎูุงุฑุงุช ุงูุชูุงุตู ูุน ููุซู ุฎุฏูุฉ ุงูุนููุงุก (ูุญูุฏ ุณูุงูุฉ)
        self.customer_service_phrases = [
            "ููุชูุงุตู ุงููุจุงุดุฑ ูุน ููุซู ุฎุฏูุฉ ุงูุนููุงุกุ ุฃุฑุณู ูููุฉ 'ููุซู ุฎุฏูุฉ ุงูุนููุงุก'",
            "ุฅุฐุง ููุช ุชุฑุบุจ ูู ุงูุชุญุฏุซ ูุจุงุดุฑุฉ ูุน ุฃุญุฏ ููุซูู ุฎุฏูุฉ ุงูุนููุงุกุ ุฃุฑุณู 'ุชุญุฏุซ ูุน ููุซู'",
            "ููุงุชุตุงู ุจููุซู ุฎุฏูุฉ ุงูุนููุงุกุ ุฃุฑุณู 'ุงุชุตุงู ุจููุซู'"
        ]
        
        # ููุช ุงูุชุธุงุฑ ุงูููุซู ุงูุจุดุฑู (ุจุงูุซูุงูู)
        self.human_rep_wait_time = 90
        
        # ูุนูููุงุช ุงูุงุชุตุงู ุจุงูููุซู ุงูุจุดุฑู (ูุญูุฏ ุณูุงูุฉ)
        self.human_rep_contact_info = {
            "name": "ูุญูุฏ ุณูุงูุฉ",
            "title": "ูุฏูุฑ ุฎุฏูุฉ ุงูุนููุงุก - ูุฌูุน ุนูุงู ูุตุฑ",
            "phone": "+201234567890",  # ุฑูู ุงูุชุฑุงุถูุ ูุฌุจ ุชุบููุฑู
            "email": "muhammad.salama@omalmisr.com",  # ุจุฑูุฏ ุงูุชุฑุงุถูุ ูุฌุจ ุชุบููุฑู
            "whatsapp": "https://wa.me/201234567890",  # ุฑุงุจุท ูุงุชุณุงุจ ุงูุชุฑุงุถูุ ูุฌุจ ุชุบููุฑู
            "messenger": "https://m.me/Omal.Misr.Foundation"
        }
        
        # ูููุงุช ููุชุงุญูุฉ ููุชุญููู ุฅูู ููุซู ุฎุฏูุฉ ุงูุนููุงุก
        self.customer_service_keywords = [
            "ููุซู ุฎุฏูุฉ ุงูุนููุงุก", "ุชุญุฏุซ ูุน ููุซู", "ุงุชุตุงู ุจููุซู", "ุชูุตูู ุจุดุฎุต ุญูููู", 
            "ุดุฎุต ุญูููู", "ุชุญููู", "ุงูุณุงู", "ููุธู", "ูุชุงุจุนุฉ", "ูุญูุฏ ุณูุงูุฉ", "ุณูุงูุฉ",
            "ุฎุฏูุฉ ุนููุงุก", "ููุฏูุจ", "ูุณุงุนุฏุฉ ุดุฎุตูุฉ"
        ]
        
        # ุฃุณุฆูุฉ ููุญุตูู ุนูู ุงุณู ุงููุณุชุฎุฏู
        self.name_questions = [
            "ูุฑุญุจุงู! ุฃูุง ูุญูุฏ ุณูุงูุฉุ ุงููุณุงุนุฏ ุงูุฑุณูู ููุฌูุน ุนูุงู ูุตุฑ. ูุง ูู ุงุณูู ุงููุฑููุ",
            "ุฃููุงู ูุณููุงู! ุฃูุง ูุญูุฏ ุณูุงูุฉ ูู ูุฌูุน ุนูุงู ูุตุฑ. ูุจู ุฃู ูุจุฏุฃุ ูููู ุฃุนุฑู ุงุณู ุญุถุฑุชูุ",
            "ุงูุณูุงู ุนูููู! ูุนู ูุญูุฏ ุณูุงูุฉ ูู ูุฌูุน ุนูุงู ูุตุฑ. ูุดุฑููู ุงูุชุนุฑู ุนูู ุงุณูู ุงููุฑูู.",
            "ูุฑุญุจุงู ุจู ูู ูุฌูุน ุนูุงู ูุตุฑ! ุฃูุง ูุญูุฏ ุณูุงูุฉ ูุณุงุนุฏู ุงูุดุฎุตู. ูุง ูู ุงุณููุ"
        ]
        
        # ุชุนุฑูู ูููู ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ ููุฎุฏูุงุช
        self.main_menu = {
            "ุฃุจุญุซ ุนู ุนูู": {
                "title": "ุฃุจุญุซ ุนู ุนูู",
                "description": "ุณุฌู ูุนูุง ูุชุฌุฏ ูุธููุชู ุงูููุงุณุจุฉ",
                "link": "https://omalmisrservices.com/ar/jobs"
            },
            "ุฃุจุญุซ ุนู ููุธููู ูุนูุงู": {
                "title": "ุฃุจุญุซ ุนู ููุธููู ู ุนูุงู",
                "description": "ุณุฌู ุจูุงูุงุชู ููุญุตูู ุนูู ููุธูููู",
                "link": "https://omalmisrservices.com/ar/workers"
            },
            "ุฎุฏูุงุช ุงูุดุฑูุงุช": {
                "title": "ุฎุฏูุงุช ุงูุดุฑูุงุช",
                "description": "ุฎุฏูุงุช ุงูุงุณุซูุงุฑ ุงูุตูุงุนู ู ุงูุฒุฑุงุนู",
                "link": "https://omalmisrservices.com/ar/companies",
                "submenu": {
                    "ุทุฑุญ ุงููุฑุต ุงูุฅุณุชุซูุงุฑูุฉ": {
                        "title": "ุทุฑุญ ุงููุฑุต ุงูุฅุณุชุซูุงุฑูุฉ",
                        "description": "ูุฎุชุต ูุฐุง ุงููุณู ุจุทุฑุญ ุงููุฑุต ุงุงูุณุชุซูุงุฑูุฉ ุงููููุฒุฉ ูู ุงููุฌุงู ุงูุตูุงุนู ู ุงููุฌุงู ุงูุฒุฑุงุนู ุจูุงุก ุนูู ุฏุฑุงุณุฉ ุงูุณูู ุงูุญุงูู",
                        "link": "https://omalmisrservices.com/ar/companies/formView?type=1&media_id=2&title=%D8%B7%D8%B1%D8%AD%20%D8%A7%D9%84%D9%81%D8%B1%D8%B5%20%D8%A7%D9%84%D8%A5%D8%B3%D8%AA%D8%AB%D9%85%D8%A7%D8%B1%D9%8A%D8%A9"
                    },
                    "ุฏุฑุงุณุงุช ุงูุฌุฏูู ุงูุฅูุชุตุงุฏูุฉ": {
                        "title": "ุฏุฑุงุณุงุช ุงูุฌุฏูู ุงูุฅูุชุตุงุฏูุฉ",
                        "description": "ุชุฃุชู ูููุฉ ูุฐุง ุงููุณู ูู ุนูู ุงูุฏุฑุงุณุงุช ุงูุงูุฒูุฉ ูููุดุฑูุน ููุฎุฏู ุชุญุช ูุธูุฉ ูุฐุง ุงููุณู ุนุฏุฏ 6 ุดุฑูุงุช ูุญููุฉ ูุฏูููุฉ ูุชุฎุตุตุฉ ูู ุฏุฑุงุณุงุช ุงูุฌุฏูู ูููุดุฑูุนุงุช ุงูุตุบูุฑุฉ ูุงููุจูุฑุฉ",
                        "link": "https://omalmisrservices.com/ar/companies/formView?type=1&media_id=3&title=%D8%AF%D8%B1%D8%A7%D8%B3%D8%A7%D8%AA%20%D8%A7%D9%84%D8%AC%D8%AF%D9%88%D9%89%20%D8%A7%D9%84%D8%A5%D8%AF%D8%A7%D8%B1%D9%8A%D8%A9"
                    },
                    "ุงูุดุฑุงูุฉ ุงูุฅุณุชุฑุงุชูุฌูุฉ": {
                        "title": "ุงูุดุฑุงูุฉ ุงูุฅุณุชุฑุงุชูุฌูุฉ",
                        "description": "ุชุชููู ูููุฉ ูุฐุง ุงููุณู ูู ุนูู ุงูุฏุฑุงุณุงุช ุงูุงูุฒูุฉ ุฅููุงูุฉ ุงููุดุฑูุน ุฅูุง ูู ุฎุงูู ุชูููุฑ ุดุฑูู ูุญูู ุงู ุดุฑูู ุงุฌูุจู ูุฃูุถุง ูู ุฎุงูู ุงููุญุงูุธ ูุงูุตูุงุฏูู ุงุฅูุณุชุซูุงุฑูุฉ",
                        "link": "https://omalmisrservices.com/ar/companies/formView?type=1&media_id=4&title=%D8%A7%D9%84%D8%B4%D8%B1%D8%A7%D9%83%D8%A9%20%D8%A7%D9%84%D8%A5%D8%B3%D8%AA%D8%B1%D8%A7%D8%AA%D9%8A%D8%AC%D9%8A%D8%A9"
                    },
                    "ุงูุฅูุดุงุกุงุช ูุงูุนูุงุฑุงุช ุงูุตูุงุนูุฉ": {
                        "title": "ุงูุฅูุดุงุกุงุช ูุงูุนูุงุฑุงุช ุงูุตูุงุนูุฉ",
                        "description": "ูุฎุชุต ูุฐุง ุงููุณู ุจุนูู ุงูุฑุณููุงุช ูุงูุชุตูููุงุช ุงูููุฏุณูุฉ ููููุดุฃุฉ ุงูุตูุงุนูุฉ ุจูุง ูุชูุงุณุจ ูุน ุฅุญุชูุงุฌุงุช ูุจูุฆุฉ ุงูุนูู ูุชูููุฑ ุงูููุงูุน ุงูุงูุฒูุฉ ุฅููุงูุฉ ุงููุดุงุฑูุน ุงูุตูุงุนูุฉ ู ุงูุฒุฑุงุนูุฉ",
                        "link": "https://omalmisrservices.com/ar/companies/formView?type=1&media_id=5&title=%D8%A7%D9%84%D8%A5%D9%86%D8%B4%D8%A7%D8%A1%D8%A7%D8%AA%20%D9%88%D8%A7%D9%84%D8%B9%D9%82%D8%A7%D8%B1%D8%A7%D8%AA%20%D8%A7%D9%84%D8%B5%D9%86%D8%A7%D8%B9%D9%8A%D8%A9"
                    },
                    "ุงูุฎุงูุงุช ููุณุชูุฒูุงุช ุงูุฅูุชุงุฌ": {
                        "title": "ุงูุฎุงูุงุช ููุณุชูุฒูุงุช ุงูุฅูุชุงุฌ",
                        "description": "ุฎุชุต ูุฐุง ุงููุณู ุจุชูููุฑ ุงูุฎุงูุงุช ููุณุชูุฒูุงุช ุงุฅููุชุงุฌ ุทุจูู ุงูุงูุฒูุฉ ุจุงููุนุงููุฑ ู ุงูููุงุตูุงุช ุงููุทููุจุฉ ุง ููุนุงููุฑ ุงูุฌูุฏุฉ ุงูุนุงูููุฉ",
                        "link": "https://omalmisrservices.com/ar/companies/formView?type=1&media_id=6&title=%D8%A7%D9%84%D8%AE%D8%A7%D9%85%D8%A7%D8%AA%20%D9%88%D9%85%D8%B3%D8%AA%D9%84%D8%B2%D9%85%D8%A7%D8%AA%20%D8%A7%D9%84%D8%A5%D9%86%D8%AA%D8%A7%D8%AC"
                    },
                    "ุงูุชุณููู ุงููุญูู ููููุชุฌุงุช": {
                        "title": "ุงูุชุณููู ุงููุญูู ููููุชุฌุงุช ุงูุตูุงุนูุฉ ู ุงูุฒุฑุงุนูุฉ",
                        "description": "ูุฎุชุต ูุฐุง ุงููุณู ุจุฅุฌุฑุงุก ุชุญููู ููุณูู ุชูููุฏุง ูุฏุฎูู ููุชุฌ ุฌุฏูุฏ ูู ุงูุณูู ูุจูุงุก ูุฎูู ุงูุงููุงุฑ ุงูุชุณููููุฉ ูุงุณุชูุฏุงู ุงููุณุชููู ูู ุฎูุงู ูุงูุฉ ุงููููุงุช ุงูุฏุนุงุฆูุฉ ูุงูุฎุทุท ุงูุชุณูููุฉ ูุชุฑููุฌ ุงูููุชุฌ ุทุจุง ูุงุญุชูุงุฌุงุช ุงูุงุณูุงู ุงููุฎุชููุฉ ุงููุญููุฉ",
                        "link": "https://omalmisrservices.com/ar/companies/formView?type=1&media_id=7&title=%D8%A7%D9%84%D8%AA%D8%B3%D9%88%D9%8A%D9%82%20%D8%A7%D9%84%D9%85%D8%AD%D9%84%D9%8A%20%D9%84%D9%84%D9%85%D9%86%D8%AA%D8%AC%D8%A7%D8%AA%20%D8%A7%D9%84%D8%B5%D9%86%D8%A7%D8%B9%D9%8A%D8%A9%20%D9%88%20%D8%A7%D9%84%D8%B2%D8%B1%D8%A7%D8%B9%D9%8A%D8%A9"
                    },
                    "ุงูุชุณููู ุงูุฏููู ููููุชุฌุงุช": {
                        "title": "ุงูุชุณููู ุงูุฏููู ููููุชุฌุงุช ุงูุตูุงุนูุฉ ู ุงูุฒุฑุงุนูุฉ",
                        "description": "ูุฎุชุต ูุฐุง ุงููุณู ุจุฅุฌุฑุงุก ุชุญููู ููุณูู ุชูููุฏุง ูุชุตุฏูุฑ ุงูููุชุฌุงุช ุงูุตูุงุนูุฉ ู ุงูุฒุฑุงุนูุฉ ูู ุฏูู ุงูุฎููุฌ ุงูุนุฑุจู ู ุฏูู ุงูุฑูููุง ู ุฏูู ุงุงูุชุญุงุฏ ุงุงููุฑูุจู ูุจูุงุก ูุฎูู ุงุฃูููุงุฑ ุงูุชุณููููุฉ ุฅูุณุชูุฏุงู ุงููุณุชููู ูู ุฎุงูู ูุงูุฉ ุงููููุงุช ุงูุฏุนุงุฆูุฉ ูุงูุฎุทุท",
                        "link": "https://omalmisrservices.com/ar/companies/formView?type=1&media_id=8&title=%D8%A7%D9%84%D8%AA%D8%B3%D9%88%D9%8A%D9%82%20%D8%A7%D9%84%D8%AF%D9%88%D9%84%D9%8A%20%D9%84%D9%84%D9%85%D9%86%D8%AA%D8%AC%D8%A7%D8%AA%20%D8%A7%D9%84%D8%B5%D9%86%D8%A7%D8%B9%D9%8A%D8%A9%20%D9%88%20%D8%A7%D9%84%D8%B2%D8%B1%D8%A7%D8%B9%D9%8A%D8%A9"
                    },
                    "ุงูุฎุฏูุงุช ุงูุญููููุฉ": {
                        "title": "ุงูุฎุฏูุงุช ุงูุญููููุฉ",
                        "description": "ูุฐุง ุงููุณู ูุฎุชุต ุจูุถุน ุญููู ููุงูุฉ ุงูุนูุจุงุช ูููุณุชุซูุฑูู ูู ุงููุทุงุน ุงูุตูุงุนู ูููุง ูููุงููู ุงุฅูุณุชุซูุงุฑ ุงูุฏูููุฉ ูุงููุญููุฉ ูุชูููุฑ ูุงูุฉ ุงูุฎุฏูุงุช ุงูุชู ุชุญุชุงุฌูุง ุงูููุดุขุช ุงูุตูุงุนูุฉ ูู ุงููุฒุงุฑุงุช ูุงูุฌูุงุช ุงูุญููููุฉ.",
                        "link": "https://omalmisrservices.com/ar/companies/formView?type=1&media_id=9&title=%D8%A7%D9%84%D8%AE%D8%AF%D9%85%D8%A7%D8%AA%20%D8%A7%D9%84%D8%AD%D9%83%D9%88%D9%85%D9%8A%D8%A9"
                    },
                    "ุฎุฏูุงุช ุงูุชุนููู ูุงูุจุญุซ ุงูุนููู": {
                        "title": "ุฎุฏูุงุช ุงูุชุนููู ูุงูุจุญุซ ุงูุนููู",
                        "description": "ุชูุฏูู ุงูุฏูุฑุงุช ุงูุชุฏุฑูุจุฉ ููููุงุฏุฑ ุงูุจุดุฑูุฉ ุงููููุฉ ูุงูุงุฏุงุฑูุฉ ุชูุฏูู ุงูุงุณุชุดุงุฑุงุช ุงููููุฉ ูุงูุงุฏุงุฑูุฉ",
                        "link": "https://omalmisrservices.com/ar/companies?type=7"
                    },
                    "ุฎุฏูุฉ ุงูุดุคูู ุงููุงููุฉ": {
                        "title": "ุฎุฏูุฉ ุงูุดุคูู ุงููุงููุฉ",
                        "description": "ุชูุฏูู ุฎุฏูุฉ ุฅุฏุงุฑุฉ ุงูุดุฆูู ุงููุงููุฉ ููููุดุขุช ุชูุฏูู ุงูุงุณุชุดุงุฑุงุช ุงููุงููุฉ ุงุฏุงุฑุฉ ุงูููู ุงูุถุฑูุจู",
                        "link": "https://omalmisrservices.com/ar/companies?type=8"
                    },
                    "ุฎุฏูุฉ ุชูููููุฌูุง ุงููุนูููุงุช": {
                        "title": "ุฎุฏูุฉ ุชูููููุฌูุง ุงููุนูููุงุช",
                        "description": "ููุฏู ูุฐุง ุงููุทุงุน ุฎุฏูุงุช ุฅูุดุงุก ุงูููุงูุน ุงูุงููุชุฑูููุฉ ูุงูุชุทุจููุงุช  ุงุฏุงุฑุฉ ุงูููุงูุน ุงูุงููุชุฑูููุฉ",
                        "link": "https://omalmisrservices.com/ar/companies?type=6"
                    },
                    "ุฎุฏูุงุช ุงูุงุณุชุดุงุฑุงุช ุงููุงููููุฉ": {
                        "title": "ุฎุฏูุงุช ุงูุงุณุชุดุงุฑุงุช ุงููุงููููุฉ",
                        "description": "ูู ูุทุงุน ูุณุฆูู ุนู ุฌููุน ุงูุงุณุชุดุงุฑุงุช ุงููุงููููุฉ ุงูุฎุงุตุฉ ุจุงูุดุฑูุงุช (ุงูุนููุฏ ูุงูุชุฑุงุฎูุต-ุฅุฏุงุฑุฉ",
                        "link": "https://omalmisrservices.com/ar/companies?type=5"
                    },
                    "ุงูุฎุฏูุงุช ุงูุงุนูุงููุฉ": {
                        "title": "ุงูุฎุฏูุงุช ุงูุงุนูุงููุฉ",
                        "description": "ูููุฑ ุงูุฃููุงุฑ ุงูุฅุนูุงููุฉ ูุงูุญููุงุช ุงูุฏุนุงุฆูุฉ ููููุฑ ุฎุฏูุงุช ุงูุฌุฑุงููู ูุงููููุชุงุฌ ุฅุฏุงุฑุฉ ุงูุณูุดูุงู ูุฏูุง",
                        "link": "https://omalmisrservices.com/ar/companies?type=4"
                    },
                    "ุฎุฏูุงุช ุชุณููู ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ": {
                        "title": "ุฎุฏูุงุช ุชุณููู ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ",
                        "description": "ูุฎุชุต ูุฐุง ุงููุทุงุน ุจุชูููุฑ ุงูููุงุฏุฑ ุงูุจุดุฑูุฉ ุงููุฏุฑุจุฉ ูุงููุคููุฉ (ุงููููุฉ ูุงูุฅุฏุงุฑูุฉ)",
                        "link": "https://omalmisrservices.com/ar/companies?type=3"
                    },
                    "ุฎุฏูุงุช ุชุณููู ูุฑุต ุงูุนูู": {
                        "title": "ุฎุฏูุงุช ุชุณููู ูุฑุต ุงูุนูู",
                        "description": "ูุฐุง ุงููุทุงุน ูุฎุชุต ูู ุงูุชูุงุตู ูุน ุงููุชูุฏููู ุนูู ุงููุธุงุฆู ู ุชุดุบูููู  ุญุณุจ ุงููุนุงููุฑ",
                        "link": "https://omalmisrservices.com/ar/companies?type=2"
                    },
                    "ุฎุฏูุฉ ุงูุฅุณุชุซูุงุฑ ุงูุตูุงุนู ูุงูุฒุฑุงุนู": {
                        "title": "ุฎุฏูุฉ ุงูุฅุณุชุซูุงุฑ ุงูุตูุงุนู ูุงูุฒุฑุงุนู",
                        "description": "ูุชู ุชูุฏูู ุงูุฎุฏูุงุช ุงูุงุณุชุซูุงุฑูุฉ ุนูู ุซูุงุซ ูุฑุงุญู: ุงูุงููู : ุทุฑุญ ุงููุฑุต ูุงูุงูุดุงุก",
                        "link": "https://omalmisrservices.com/ar/companies?type=1"
                    }
                }
            },
            "ุจูุงุจุฉ ูุถ ุงูููุงุฒุนุงุช": {
                "title": "ุจูุงุจุฉ ูุถ ู ุชุณููุฉ ุงูููุงุฒุงุนุงุช",
                "description": "ูู ุจูุงุจุฉ ุฅููุชุฑููุฉ ููุถ ู ุชุณููุฉ ุงูููุงุฒุงุนุงุช ุงููุงุชุฌูุฉ ุจูู ูุคุณุณุชูู ุฃู ุฃูุซุฑ ุฃู ุจูู ุงููุคุณุณุงุช ู ุงูุนุงูููู ุจูุง ุจูุณุทุฉ ุฎุจุฑุงุก ู ูุณุชุดุงุฑูู ูุงููููู ูุชุฎุตุตูู ุฏูู ุงููุฌูุก ุฅูู ุงูุฌูุงุช ุงููุถุงุฆูุฉ ู ูู ุชุชุจุน ูุคุณุณุฉ ุนูุงู ูุตุฑ",
                "link": "https://omalmisrservices.com/ar/dispute",
                "submenu": {
                    "ูุฒุงุน ุงูููุดุฃุช": {
                        "title": "ูุฒุงุน ุงูููุดุฃุช",
                        "description": "ุฎุฏูุฉ ูุถ ุงูููุงุฒุนุงุช ุจูู ุงูููุดุขุช",
                        "link": "https://omalmisrservices.com/ar/dispute/facility"
                    },
                    "ูุฒุงุน ุงูุนูุงู": {
                        "title": "ูุฒุงุน ุงูุนูุงู",
                        "description": "ุฎุฏูุฉ ูุถ ุงูููุงุฒุนุงุช ุจูู ุงูุนูุงู ูุงูููุดุขุช",
                        "link": "https://omalmisrservices.com/ar/dispute/worker"
                    }
                }
            },
            "ูู ูุญู": {
                "title": "ูู ูุญู",
                "description": "ุงูุฑูุงุฏุฉ ูู ุตูุงุนุฉ ุงูุฎุฏูุงุช ูุญูููุง ูุนุงููููุง ููุณูู ุงูุตูุงุนู ูู ุฎุงู ุชูุญูุฏ ุจุงุจ ุงูุฎุฏูุฉ ูููุณุชุซูุฑ ุงูุตูุงุนู ุจุงุณุชุฎุฏุงู ุฃุญุฏุซ ุงูุฃุณุงููุจ ูุงูุฃุฏูุงุช ุงูุชูููููุฌูุฉ ููููุง ูุงุณุชุฑุงุชูุฌูุฉ ุงูุชูููุฉ ุงููุณุชุฏุงูุฉ ุงูุนุงูููุฉ ููุดุฑ ุงููุนู ุจุงูุซูุงูุฉ ุงูุตูุงุนูุฉ ูุฃูููุชูุง ูุฒูุงุฏุฉ ุงูุฅูุชุงุฌ ูุน ุงูุชูุณู ุจุนููุฏุฉ ุนูู ูุคุณุณุฉ ูุงููููุถ ุจุฃุนุถุงุฆูุง ููุณุชุซูุฑููุง.",
                "link": "https://www.omalmisr.com/about",
                "submenu": {
                    "ุฑุคูุชูุง": {
                        "title": "ุฑุคูุชูุง",
                        "description": "ูุนูู ุจุฑุคูุฉ ูุณุชุฏุงูุฉ ุญุชู ุชุตุจุญ ููุธููุฉ ุนูุงู ูุตุฑ ููุงู ุฎุฏูู ุตูุงุนู ุชุนูููู ุฒุฑุงุนู ูุคุซุฑ ูู ููุธููุฉ ุงูุงูุชุตุงุฏ ุงูุฏููู ูุฃู ุชููุฏ ุนูุงู ูุตุฑ ุฃูุจุฑ ุชูุชู ุตูุงุนู ููุญูุธุฉ ุฅุณุชุซูุงุฑูุฉ ุตูุงุนูุฉ ูู ุงูุงููู ูู ููุนูุง ุฅูุฑูููุง ูุน",
                        "link": "https://www.omalmisr.com/about"
                    },
                    "ุฑุณุงูุชูุง": {
                        "title": "ุงูุฑุณุงูุฉ",
                        "description": "ุงูุฑูุงุฏุฉ ูู ุตูุงุนุฉ ุงูุฎุฏูุงุช ูุญูููุง ูุนุงููููุง ููุณูู ุงูุตูุงุนู ูู ุฎุงู ุชูุญูุฏ ุจุงุจ ุงูุฎุฏูุฉ ูููุณุชุซูุฑ ุงูุตูุงุนู ุจุงุณุชุฎุฏุงู ุฃุญุฏุซ ุงูุฃุณุงููุจ ูุงูุฃุฏูุงุช ุงูุชูููููุฌูุฉ ููููุง ูุงุณุชุฑุงุชูุฌูุฉ ุงูุชูููุฉ ุงููุณุชุฏุงูุฉ ุงูุนุงูููุฉ ููุดุฑ ุงููุนู ุจุงูุซูุงูุฉ ุงูุตูุงุนูุฉ ูุฃูููุชูุง ูุฒูุงุฏุฉ ุงูุฅูุชุงุฌ ูุน ุงูุชูุณู ุจุนููุฏุฉ ุนูู ูุคุณุณุฉ ูุงููููุถ ุจุฃุนุถุงุฆูุง ููุณุชุซูุฑููุง.",
                        "link": "https://www.omalmisr.com/about"
                    },
                    "ุฃูุฏุงููุง": {
                        "title": "ุงูุฏุงููุง",
                        "description": "ุชูุญูุฏ ุจุงุจ ุงูุฎุฏูุฉ ูููุณุชุซูุฑ ุงูุตูุงุนู. ุฃู ูููู ุงูุจูุงุจุฉ ุงูุฑุงุฆุฏุฉ ูููุณุชุซูุฑูู ุงูุตูุงุนููู ูุงูููุงุฏุฑ ุงูุจุดุฑูุฉ ูุฏุฎูููู ุณูู ุงูุนูู ุงูุตูุงุนู. ุฃู ูุตุจุญ ููุธููุฉ ุฅูุชุตุงุฏูุฉ ุชุคุซุฑ ูู ุณูู ุงูุนูู ุงูุนุงููู.",
                        "link": "https://www.omalmisr.com/about"
                    }
                }
            },
            "ุชูุงุตู ูุนูุง": {
                "title": "ุชูุงุตู ูุนูุง",
                "description": "ุชูุงุตู ูุน ูุฌูุน ุนูุงู ูุตุฑ",
                "link": "https://www.omalmisr.com/contact",
                "submenu": {
                    "ุงูุณูุดูุงู ููุฏูุง": {
                        "title": "ุชุงุจุนูุง ุนูู ุงูุณูุดูุงู ููุฏูุง",
                        "description": "ุชุงุจุน ุตูุญุงุชูุง ุนูู ููุตุงุช ุงูุชูุงุตู ุงูุงุฌุชูุงุนู",
                        "links": {
                            "ููุชููุจ": "https://www.youtube.com/channel/UCAkYTIf30ypaEE5gfrMhdUw",
                            "ุงูุณุชุบุฑุงู": "https://www.instagram.com/omalmisr/",
                            "ููููุฏ ุฅู": "https://www.linkedin.com/company/79479037/admin/feed/posts/",
                            "ุชููุชุฑ": "https://twitter.com/omalmisr1",
                            "ููุณุจูู": "https://www.facebook.com/Omal.Misr.Foundation/"
                        }
                    }
                }
            }
        }
        
        logger.info(f"ุชู ุชููุฆุฉ ChatBot ุจูุฌุงุญ. ุงุณู ุงูุดุงุช ุจูุช: {self.bot_name}ุ ููู ุงูุจูุงูุงุช: {self.data_file}")
    
    def load_data(self) -> None:
        """
        ุชุญููู ุงูุจูุงูุงุช ูู ููู JSON
        """
        try:
            with open(self.data_file, 'r', encoding='utf-8') as f:
                data = json.load(f)
                self.prompts = data.get("prompts", [])
                self.human_expressions = data.get("human_expressions", {})
                self.contact_info = data.get("contact_info", {})
                self.requires_human_contact = data.get("requires_human_contact", [])
                self.user_categories = data.get("user_categories", [])
                self.job_sectors = data.get("job_sectors", [])
                self.personalize_response = data.get("personalize_response", self.personalize_response)
                
                # ุชุญููู ุจูุงูุงุช ุงูุฎุฏูุงุช ูุงูุฑูุงุจุท
                self.service_links = data.get("service_links", {})
                self.service_categories = data.get("service_categories", {})
                
            logger.info(f"ุชู ุชุญููู {len(self.prompts)} ุณุคุงู ูุฌูุงุจ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช")
            
            if self.human_expressions:
                logger.info(f"ุชู ุชุญููู ุชุนุจูุฑุงุช ุจุดุฑูุฉ ูู {len(self.human_expressions)} ูุฆุฉ ูุฎุชููุฉ")
            
            if self.user_categories:
                logger.info(f"ุชู ุชุญููู {len(self.user_categories)} ูุฆุฉ ูู ุงููุณุชุฎุฏููู")
            
            if self.service_links:
                logger.info(f"ุชู ุชุญููู {len(self.service_links)} ุฑุงุจุท ูุฎุฏูุงุช ุงููุฌูุน")
            
        except FileNotFoundError:
            error_msg = f"ุฎุทุฃ: ูู ูุชู ุงูุนุซูุฑ ุนูู ููู ุงูุจูุงูุงุช '{self.data_file}'"
            logger.error(error_msg)
            print(error_msg)
        except json.JSONDecodeError:
            error_msg = f"ุฎุทุฃ: ููู ุงูุจูุงูุงุช '{self.data_file}' ููุณ ุจุตูุบุฉ JSON ุตุงูุญุฉ"
            logger.error(error_msg)
            print(error_msg)
        except Exception as e:
            error_msg = f"ุฎุทุฃ ุบูุฑ ูุชููุน ุฃุซูุงุก ุชุญููู ุงูุจูุงูุงุช: {e}"
            logger.error(error_msg)
            print(error_msg)
    
    def set_conversation_source(self, source: str) -> None:
        """
        ุชุนููู ูุตุฏุฑ ุงููุญุงุฏุซุฉ (ูุงุณูุฌุฑ ุฃู ุชุนููู ููุณุจูู)
        
        :param source: ูุตุฏุฑ ุงููุญุงุฏุซุฉ ("messenger" ุฃู "facebook_comment")
        """
        if source in ["messenger", "facebook_comment"]:
            self.conversation_source = source
            logger.debug(f"ุชู ุชุนููู ูุตุฏุฑ ุงููุญุงุฏุซุฉ: {source}")
        else:
            logger.warning(f"ูุตุฏุฑ ูุญุงุฏุซุฉ ุบูุฑ ุตุงูุญ: {source}. ุงุณุชุฎุฏุงู ุงูุงูุชุฑุงุถู: messenger")
            self.conversation_source = "messenger"

    def _get_random_expression(self, category: str) -> str:
        """
        ุงูุญุตูู ุนูู ุชุนุจูุฑ ุนุดูุงุฆู ูู ูุฆุฉ ูุนููุฉ
        
        :param category: ูุฆุฉ ุงูุชุนุจูุฑ (greetings, positive_responses, ุฅูุฎ)
        :return: ุชุนุจูุฑ ุนุดูุงุฆู ุฃู ูุต ูุงุฑุบ ุฅุฐุง ูู ุชูู ุงููุฆุฉ ููุฌูุฏุฉ
        """
        expressions = self.human_expressions.get(category, [])
        
        if expressions and len(expressions) > 0:
            return random.choice(expressions)
        
        return ""

    def generate_menu_buttons(self, menu_type: str = "main", submenu_key: str = None) -> str:
        """
        ุชูููุฏ ูุงุฆูุฉ ุงูุฃุฒุฑุงุฑ ูุนุฑุถูุง ูู ุงููุญุงุฏุซุฉ
        
        :param menu_type: ููุน ุงููุงุฆูุฉ ("main" ูููุงุฆูุฉ ุงูุฑุฆูุณูุฉ ุฃู "submenu" ูููุงุฆูุฉ ุงููุฑุนูุฉ)
        :param submenu_key: ููุชุงุญ ุงููุงุฆูุฉ ุงููุฑุนูุฉ ุงููุทููุจุฉ (ูุซูุงู "ุฎุฏูุงุช ุงูุดุฑูุงุช")
        :return: ูุต ูุญุชูู ุนูู ุงููุงุฆูุฉ ุงููุทููุจุฉ
        """
        menu_text = "๐ ุงุฎุชุฑ ูู ุงูุฎุฏูุงุช ุงูุชุงููุฉ:\n\n"
        
        if menu_type == "main":
            # ุนุฑุถ ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ
            for key, item in self.main_menu.items():
                menu_text += f"โซ๏ธ {item['title']}\n"
                menu_text += f"  {item['description']}\n"
                menu_text += f"  {item['link']}\n\n"
            
            menu_text += "ููููู ุงุฎุชูุงุฑ ุฃู ูู ุงูุฎุฏูุงุช ุฃุนูุงู ุฃู ุงูุงุณุชูุณุงุฑ ุนููุง ุจุงูุชูุตูู."
        
        elif menu_type == "submenu" and submenu_key and submenu_key in self.main_menu:
            menu_item = self.main_menu[submenu_key]
            if "submenu" in menu_item:
                menu_text = f"๐ ุฎุฏูุงุช {menu_item['title']}:\n\n"
                for key, subitem in menu_item["submenu"].items():
                    menu_text += f"โซ๏ธ {subitem['title']}\n"
                    menu_text += f"  {subitem['description']}\n"
                    
                    if key == "ุงูุณูุดูุงู ููุฏูุง" and "links" in subitem:
                        menu_text += "  ููุตุงุช ุงูุชูุงุตู ุงูุงุฌุชูุงุนู:\n"
                        for platform, link in subitem["links"].items():
                            menu_text += f"  - {platform}: {link}\n"
                    else:
                        menu_text += f"  {subitem['link']}\n"
                    
                    menu_text += "\n"
                
                menu_text += f"ููุนูุฏุฉ ูููุงุฆูุฉ ุงูุฑุฆูุณูุฉุ ุงูุชุจ 'ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ'."
        
        return menu_text
    
    def process_menu_request(self, user_message: str) -> Optional[str]:
        """
        ูุนุงูุฌุฉ ุทูุจุงุช ุงููุณุชุฎุฏู ุงููุชุนููุฉ ุจุงูููุงุฆู
        
        :param user_message: ุฑุณุงูุฉ ุงููุณุชุฎุฏู
        :return: ุฑุฏ ุงููุงุฆูุฉ ุงููุทููุจุฉ ุฃู None ุฅุฐุง ูู ุชูู ุงูุฑุณุงูุฉ ูุชุนููุฉ ุจุงูููุงุฆู
        """
        user_message = user_message.strip().lower()
        
        # ุทูุจ ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ
        if user_message in ["ุงููุงุฆูุฉ", "ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ", "ุงูุฎุฏูุงุช", "ุฎุฏูุงุช", "ุงูุฎูุงุฑุงุช", "ูุงุฆูุฉ", "menu", "services"]:
            return self.generate_menu_buttons(menu_type="main")
        
        # ุทูุจ ูุงุฆูุฉ ูุฑุนูุฉ
        for key, item in self.main_menu.items():
            if user_message in [key.lower(), item["title"].lower()]:
                if "submenu" in item:
                    return self.generate_menu_buttons(menu_type="submenu", submenu_key=key)
                else:
                    # ุฅุฐุง ูู ููู ููุงู ูุงุฆูุฉ ูุฑุนูุฉุ ุฃุนุฏ ูุนูููุงุช ุนู ุงูุฎุฏูุฉ ููุณูุง
                    response = f"๐ {item['title']}\n\n"
                    response += f"{item['description']}\n\n"
                    response += f"ููุชุณุฌูู: {item['link']}\n\n"
                    response += "ููุนูุฏุฉ ูููุงุฆูุฉ ุงูุฑุฆูุณูุฉุ ุงูุชุจ 'ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ'."
                    return response
        
        # ุงูุจุญุซ ูู ุงูููุงุฆู ุงููุฑุนูุฉ
        for main_key, main_item in self.main_menu.items():
            if "submenu" in main_item:
                for sub_key, sub_item in main_item["submenu"].items():
                    if user_message in [sub_key.lower(), sub_item["title"].lower()]:
                        response = f"๐ {sub_item['title']}\n\n"
                        response += f"{sub_item['description']}\n\n"
                        
                        if "links" in sub_item:
                            response += "ุฑูุงุจุท ููุตุงุช ุงูุชูุงุตู ุงูุงุฌุชูุงุนู:\n"
                            for platform, link in sub_item["links"].items():
                                response += f"- {platform}: {link}\n"
                        else:
                            response += f"ููุชุณุฌูู: {sub_item['link']}\n\n"
                        
                        response += f"\nููุนูุฏุฉ ููุงุฆูุฉ {main_item['title']}ุ ุงูุชุจ '{main_item['title']}'.\n"
                        response += "ููุนูุฏุฉ ูููุงุฆูุฉ ุงูุฑุฆูุณูุฉุ ุงูุชุจ 'ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ'."
                        return response
        
        # ุงูุจุญุซ ูู ุงููุงุฆูุฉ ุจุงุณุชุฎุฏุงู ูููุงุช ููุชุงุญูุฉ
        keywords_map = {
            "ูุธุงุฆู": "ุฃุจุญุซ ุนู ุนูู",
            "ุชูุธูู": "ุฃุจุญุซ ุนู ุนูู",
            "ุนูู": "ุฃุจุญุซ ุนู ุนูู",
            "ูุธููุฉ": "ุฃุจุญุซ ุนู ุนูู",
            "ูุฑุตุฉ ุนูู": "ุฃุจุญุซ ุนู ุนูู",
            "ุจุงุญุซ ุนู ุนูู": "ุฃุจุญุซ ุนู ุนูู",
            "ุณูุฑุฉ ุฐุงุชูุฉ": "ุฃุจุญุซ ุนู ุนูู",
            
            "ููุธููู": "ุฃุจุญุซ ุนู ููุธููู ูุนูุงู",
            "ุนูุงู": "ุฃุจุญุซ ุนู ููุธููู ูุนูุงู",
            "ุนูุงูุฉ": "ุฃุจุญุซ ุนู ููุธููู ูุนูุงู",
            "ุชูููุฑ ุนูุงู": "ุฃุจุญุซ ุนู ููุธููู ูุนูุงู",
            
            "ุดุฑูุงุช": "ุฎุฏูุงุช ุงูุดุฑูุงุช",
            "ุงุณุชุซูุงุฑ": "ุฎุฏูุงุช ุงูุดุฑูุงุช",
            "ูุฑุต ุงุณุชุซูุงุฑูุฉ": "ุฎุฏูุงุช ุงูุดุฑูุงุช",
            "ุฌุฏูู": "ุฎุฏูุงุช ุงูุดุฑูุงุช",
            "ููุชุฌุงุช": "ุฎุฏูุงุช ุงูุดุฑูุงุช",
            "ุฎุงูุงุช": "ุฎุฏูุงุช ุงูุดุฑูุงุช",
            "ุชุณููู": "ุฎุฏูุงุช ุงูุดุฑูุงุช",
            "ูุงููุฉ": "ุฎุฏูุงุช ุงูุดุฑูุงุช",
            "ูุงููููุฉ": "ุฎุฏูุงุช ุงูุดุฑูุงุช",
            "ุชุนููู": "ุฎุฏูุงุช ุงูุดุฑูุงุช",
            
            "ูุฒุงุน": "ุจูุงุจุฉ ูุถ ุงูููุงุฒุนุงุช",
            "ููุงุฒุนุงุช": "ุจูุงุจุฉ ูุถ ุงูููุงุฒุนุงุช",
            "ูุดููุฉ": "ุจูุงุจุฉ ูุถ ุงูููุงุฒุนุงุช",
            "ุชุณููุฉ": "ุจูุงุจุฉ ูุถ ุงูููุงุฒุนุงุช",
            "ุดููู": "ุจูุงุจุฉ ูุถ ุงูููุงุฒุนุงุช",
            
            "ุชูุงุตู": "ุชูุงุตู ูุนูุง",
            "ุงุชุตู": "ุชูุงุตู ูุนูุง",
            "ูุงุชู": "ุชูุงุตู ูุนูุง",
            "ุนููุงู": "ุชูุงุตู ูุนูุง",
            "ุณูุดูุงู": "ุชูุงุตู ูุนูุง",
            "ููุณุจูู": "ุชูุงุตู ูุนูุง",
            "ููุชููุจ": "ุชูุงุตู ูุนูุง",
            
            "ูุนูููุงุช": "ูู ูุญู",
            "ูู ูู": "ูู ูุญู",
            "ุฑุคูุฉ": "ูู ูุญู",
            "ุฑุณุงูุฉ": "ูู ูุญู",
            "ูุฏู": "ูู ูุญู",
            "ุฃูุฏุงู": "ูู ูุญู"
        }
        
        # ุงูุจุญุซ ุนู ูููุงุช ููุชุงุญูุฉ ูู ุฑุณุงูุฉ ุงููุณุชุฎุฏู
        for keyword, menu_key in keywords_map.items():
            if keyword in user_message:
                if menu_key in self.main_menu:
                    # ุฅุฐุง ูุงูุช ูููุฉ ููุชุงุญูุฉ ููุงุฆูุฉ ุฑุฆูุณูุฉ
                    if "submenu" in self.main_menu[menu_key]:
                        return self.generate_menu_buttons(menu_type="submenu", submenu_key=menu_key)
                    else:
                        item = self.main_menu[menu_key]
                        response = f"๐ {item['title']}\n\n"
                        response += f"{item['description']}\n\n"
                        response += f"ููุชุณุฌูู: {item['link']}\n\n"
                        response += "ููุนูุฏุฉ ูููุงุฆูุฉ ุงูุฑุฆูุณูุฉุ ุงูุชุจ 'ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ'."
                        return response
        
        # ูู ูุชู ุงูุนุซูุฑ ุนูู ุทูุจ ูุงุฆูุฉ
        return None

    def _detect_user_category(self, message: str) -> str:
        """
        ูุญุงููุฉ ุชุญุฏูุฏ ูุฆุฉ ุงููุณุชุฎุฏู ูู ุฑุณุงูุชู
        
        :param message: ุฑุณุงูุฉ ุงููุณุชุฎุฏู
        :return: ูุฆุฉ ุงููุณุชุฎุฏู ุงููุญุชููุฉ
        """
        message = message.lower()
        
        # ูููุงุช ููุชุงุญูุฉ ููุจุงุญุซูู ุนู ุนูู
        job_seekers_keywords = [
            "ูุธููุฉ", "ุนูู", "ุชูุธูู", "ุดุบู", "ูุฑุชุจ", "ุฑุงุชุจ", "ุชูุฏูู", "ุณูุฑุฉ ุฐุงุชูุฉ", 
            "ุฎุจุฑุฉ", "ุฎุฑูุฌ", "ุชุฏุฑูุจ", "ุชุนููู", "ูุคูู", "cv", "ูุฑุตุฉ"
        ]
        
        # ูููุงุช ููุชุงุญูุฉ ูููุณุชุซูุฑูู
        investors_keywords = [
            "ุงุณุชุซูุงุฑ", "ูุดุฑูุน", "ุชูููู", "ุดุฑุงูุฉ", "ุฑุฃุณ ูุงู", "ุฑุจุญ", "ุนุงุฆุฏ", "ูุฑุตุฉ ุงุณุชุซูุงุฑูุฉ",
            "ุชุนุงูู", "ุฑุฌู ุฃุนูุงู", "ูุณุชุซูุฑ", "ูุดุฑูุน"
        ]
        
        # ูููุงุช ููุชุงุญูุฉ ููุตุญูููู
        media_keywords = [
            "ุตุญูู", "ุฅุนูุงู", "ููุงุจูุฉ", "ุชุตุฑูุญ", "ุฎุจุฑ", "ุชูุฑูุฑ", "ูุฌูุฉ", "ุฌุฑูุฏุฉ", "ุชููุฒููู", 
            "ุฑุงุฏูู", "ุฅุฐุงุนุฉ", "ุชุบุทูุฉ", "ุตุญุงูุฉ", "ูุดุฑ", "ููุงู"
        ]
        
        # ูููุงุช ููุชุงุญูุฉ ููุดุฑูุงุช ูุงูุฌูุงุช
        companies_keywords = [
            "ุดุฑูุฉ", "ูุคุณุณุฉ", "ุฌูุฉ", "ูุตูุน", "ุชุนุงูู", "ุดุฑุงูุฉ", "ุชูุงูู", "ุจุฑูุชูููู", 
            "ุงุชูุงููุฉ", "ูุฐูุฑุฉ", "ุชูุณูู", "ุฌุงูุนุฉ", "ูุนูุฏ", "ูุฏุฑุณุฉ"
        ]
        
        # ุงูุจุญุซ ุนู ุงููููุงุช ุงูููุชุงุญูุฉ ูู ุงูุฑุณุงูุฉ
        for keyword in job_seekers_keywords:
            if keyword in message:
                logger.debug(f"ุชู ุชุตููู ุงููุณุชุฎุฏู ูู 'ุจุงุญุซ ุนู ุนูู' ุจูุงุกู ุนูู ุงููููุฉ ุงูููุชุงุญูุฉ: {keyword}")
                return "ุจุงุญุซ ุนู ุนูู"
        
        for keyword in investors_keywords:
            if keyword in message:
                logger.debug(f"ุชู ุชุตููู ุงููุณุชุฎุฏู ูู 'ูุณุชุซูุฑ' ุจูุงุกู ุนูู ุงููููุฉ ุงูููุชุงุญูุฉ: {keyword}")
                return "ูุณุชุซูุฑ"
        
        for keyword in media_keywords:
            if keyword in message:
                logger.debug(f"ุชู ุชุตููู ุงููุณุชุฎุฏู ูู 'ุตุญูู' ุจูุงุกู ุนูู ุงููููุฉ ุงูููุชุงุญูุฉ: {keyword}")
                return "ุตุญูู"
        
        for keyword in companies_keywords:
            if keyword in message:
                logger.debug(f"ุชู ุชุตููู ุงููุณุชุฎุฏู ูู 'ุดุฑูุฉ' ุจูุงุกู ุนูู ุงููููุฉ ุงูููุชุงุญูุฉ: {keyword}")
                return "ุดุฑูุฉ"
        
        # ุฅุฐุง ูู ูุชู ุชุญุฏูุฏ ุงููุฆุฉุ ุฃุนุฏ ูุฆุฉ ุงูุชุฑุงุถูุฉ
        logger.debug("ูู ูุชู ุชุญุฏูุฏ ูุฆุฉ ูุญุฏุฏุฉ ูููุณุชุฎุฏู")
        return ""